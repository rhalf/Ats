<form>
	<table>
		<tr><td>Company Name</td><td><select name="productOfferedCompanyName"/></td></tr>
		<tr><td colspan="2"><hr/></td></tr>
		<tr><td>Contact Person</td><td><select name="productOfferedContactPerson"/></td></tr>
		<tr><td>Contact Data</td><td><input type="text" name="productOfferedContactData" disabled="true" /></input></td></tr>
		<tr><td>Contact Type</td><td><input type="text" name="productOfferedContactType"  disabled="true" /></input></td></tr>
		<tr><td colspan="2"><hr/></td></tr>
		<tr><td>Product</td><td><select name="productOfferedProduct" /></td></tr>
		<tr><td>Client Response</td><td><select type="text" name="productOfferedClientResponse"/></td></tr>
		<tr><td colspan="2"><hr/></td></tr>
	</table>
</form>

<button id="buttonProductOfferedUpdate">Update</button>


<script type="text/javascript">
	globalLoadCompany(function() {
		$.each(globalCompany, function(index,object){
			$('[name="productOfferedCompanyName"]').append("<option value='"+ object.Id +"'>"+ object.Name +"</option>");
		});		
		$('[name="productOfferedCompanyName"] option[value="'+ productOffered.Company +'"]').attr('selected','selected');
	});

	$('[name="productOfferedCompanyName"]').on('change', function() {
		globalLoadContact(function() {
			$('[name="productOfferedContactPerson"]').empty();
			var companyId = $('[name="productOfferedCompanyName"]').find(":selected").val();

			$.each(globalContact, function(index,object){
				if (companyId == object.Company) {
					$('[name="productOfferedContactPerson"]').append("<option value='"+ object.Id +"'>"+ object.Person + " " + getContactType(object.Type).Name +"</option>");
					$('[name="productOfferedContactData"]').val(object.Data);
					$('[name="productOfferedContactType"]').val(getContactType(object.Type).Name);
				}
			});
		});
	});
	// //=====================
	// $('[name="productOfferedContactPerson"]').on('change', function() {
	// 	globalLoadContact(function() {
	// 		var contactId = $('[name="productOfferedContactPerson"').find(":selected").val();

	// 		$.each(globalContact, function(index,object){
	// 			if (contactId == object.Id) {
	// 				$('[name="productOfferedContactData"]').val(object.Data);
	// 				$('[name="productOfferedContactType"]').val(getContactType(object.Type).Name);
	// 			}
	// 		});
	// 	});
	// });
	// //=====================
	// $('[name="productOfferedContactPerson"]').on('change', function() {
	// 	globalLoadContact(function() {
	// 		var contactId = $('[name="productOfferedContactPerson"').find(":selected").val();

	// 		$.each(globalContact, function(index,object){
	// 			if (contactId == object.Id) {
	// 				$('[name="productOfferedContactData"]').val(object.Data);
	// 				$('[name="productOfferedContactType"]').val(getContactType(object.Type).Name);
	// 			}
	// 		});
	// 	});
	// });
	// //=====================

	// globalLoadProduct(function() {
	// 	$.each(globalProduct, function(index,object){
	// 		$('[name="productOfferedProduct"]').append("<option value='"+ object.Id +"'>"+ object.Name  +"</option>");
	// 	});
	// });
	// globalLoadClientResponse(function() {
	// 	$.each(globalClientResponse, function(index,object){
	// 		$('[name="productOfferedClientResponse"]').append("<option value='"+ object.Id +"'>"+ object.Name  +"</option>");
	// 	});
	// });


$('#buttonProductOfferedUpdate').button().click(function() {
	var company = $('[name="productOfferedCompanyName"').find(":selected").val();
	var contact = $('[name="productOfferedContactPerson"').find(":selected").val();
	var product = $('[name="productOfferedProduct"').find(":selected").val();
	var clientResponse = $('[name="productOfferedClientResponse"').find(":selected").val();



	validate = new Validate();


	if(
		validate.IsEmpty(company) || 
		validate.IsEmpty(contact) || 
		validate.IsEmpty(product) ||
		validate.IsEmpty(clientResponse) 
		) {
		notifyError("Some field(s) is/are empty.");
	return;
}




$.post('application/model/service/product_offered_update.php',{
	Company:company,
	Contact:contact,
	Product:product,
	ClientResponse:clientResponse

}, function(json){
	var result = json.result[0];
	if (result.Status == "SUCCESS") {
		notify(result.Message);
	} else {
		notifyError(result.Message);
	}
}, 'json');
});

</script>

<style type="text/css">
	form {
		font-size: 0.8em;
	}
	form table{
		width: 100%;
	}
	form input{
		width: 100%;
	}
	form select {
		width: 100%;
	}
	form div {
		width: 100%;
	}

	#buttonCompanyAdd{
		width: 100%;
	}
</style>

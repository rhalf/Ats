<form>
	<table>
		<tr><td>Company Name</td><td><select name="productOfferedCompanyName"/></td></tr>
		<tr><td colspan="2"><hr/></td></tr>
		<tr><td>Contact Person</td><td><select name="productOfferedContactPerson"/></td></tr>
		<tr><td>Contact Data</td><td><select name="productOfferedContactData"/></input></td></tr>
		<tr><td>Contact Type</td><td><input type="text" name="productOfferedContactType"></input></td></tr>
		<tr><td colspan="2"><hr/></td></tr>
		<tr><td>Product</td><td><select name="productOfferedProduct" /></td></tr>
		<tr><td>Client Response</td><td><input type="text" name="productOfferedClientResponse"></input></td></tr>
		<tr><td colspan="2"><hr/></td></tr>
	</table>
</form>

<button id="buttonProductOfferedAdd" >Add</button>


<script type="text/javascript">
	globalLoadCompany(function() {
		$.each(globalCompany, function(index,object){
			$('[name="productOfferedCompanyName"]').append("<option value='"+ object.Id +"'>"+ object.Name +"</option>");
		});

	});

	$('[name="productOfferedCompanyName"]').on('change', function() {
		
		globalLoadContact(function() {
			$('[name="productOfferedContactPerson"]').empty();
			var companyId = $('[name="productOfferedCompanyName"').find(":selected").val();

			$.each(globalContact, function(index,object){
				if (companyId == object.Company) {
					$('[name="productOfferedContactPerson"]').append("<option value='"+ object.Id +"'>"+ object.Person + " " + getContactType(object.Type).Name +"</option>");
				}
			});
		});
	});



	$('#buttonProductOfferedAdd').button().click(function() {
		var companyName = $('[name="productOfferedCompanyName"').find(":selected").val();
		var contactPerson = $('[name="productOfferedContactPerson"').find(":selected").val();
		var contactData = $('[name="productOfferedContactData"]').find(":selected").val();
		var contactType = $('[name="productOfferedContactType"]').val();

		
		validate = new Validate();




		if(
			validate.IsEmpty(name) || 
			validate.IsEmpty(description) || 
			validate.IsEmpty(addressName)
			) {
			notifyError("Some field(s) is/are empty.");
		return;
	}

	if (
		validate.IsEmpty(contactMobile) &&  
		validate.IsEmpty(contactLandLine) &&
		validate.IsEmpty(contactEmail) &&
		validate.IsEmpty(contactFax)
		) {
		notifyError("Please provide atleast one contact.");
	return;
}

$.post('application/model/service/company_insert_all.php',{
	Name:name,
	Description:description,
	BusinessField:businessField,

	AddressName:addressName,
	AddressDetail:addressDetail,
	AddressLatitude:addressLatitude,
	AddressLongitude:addressLongitude,

	ContactMobile:contactMobile,
	ContactLandLine:contactLandLine,
	ContactEmail:contactEmail,
	ContactFax:contactFax

}, function(json){
	var result = json.result[0];
	if (result.Status == "SUCCESS") {
		notify(result.Message);
	} else {
		notifyError(result.Message);
	}
}, 'json');
});


</script>

<style type="text/css">
	form {
		font-size: 0.8em;
	}
	form table{
		width: 100%;
	}
	form input{
		width: 100%;
	}
	form select {
		width: 100%;
	}
	form div {
		width: 100%;
	}

	#buttonCompanyAdd{
		width: 100%;
	}
</style>
